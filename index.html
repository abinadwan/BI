<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="app-title">حاسبة التكلفة التقديرية للمواد | Material Cost Estimator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="top-bar">
                <div class="button-group">
                    <label for="themeToggle" id="theme-label"></label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="themeToggle">
                        <span class="slider"></span>
                    </label>
                    <label for="langToggle" id="lang-label"></label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="langToggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="logo-container">
                <img src="logo2.png" alt="Logo">
                <h1 class="service-name">حاسبة التكلفة التقديرية</h1>
            </div>
        </header>

        <section class="controls-container">
            <h2><span id="project-details-title">Project Details</span></h2>
            <div class="controls-grid">
                <div class="form-group">
                    <label for="projectName" id="project-name-label">Project Name</label>
                    <input type="text" id="projectName">
                </div>
                <div class="form-group">
                    <label for="vatRate" id="vat-rate-label">VAT Rate %</label>
                    <input type="number" id="vatRate" value="15" min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label for="currencySelect" id="currency-label">Currency</label>
                    <select id="currencySelect">
                        <option value="SAR">SAR</option>
                        <option value="USD">USD</option>
                        <option value="EUR">EUR</option>
                        <option value="GBP">GBP</option>
                    </select>
                    <small id="rateInfo" class="currency-rate-info"></small>
                </div>
                <button id="refreshRateBtn" class="action-button"><i class="fas fa-sync-alt"></i> <span id="refresh-rate-btn">Refresh Rate</span></button>
                <div id="rate-error-message"></div>
            </div>
        </section>

        <section class="controls-container">
            <h2><span id="item-management-title">Item Management</span></h2>
            <div class="button-group">
                <button id="addItemBtn" class="action-button"><i class="fas fa-plus"></i> <span id="add-item-btn">Add Item</span></button>
                <button id="clearAllBtn" class="action-button delete-btn"><i class="fas fa-trash-alt"></i> <span id="clear-all-btn">Clear All</span></button>
            </div>
        </section>
        
        <section class="table-container">
            <table>
                <thead>
                    <tr id="table-headers">
                        <th>#</th>
                        <th>Item</th>
                        <th>Unit</th>
                        <th>Qty</th>
                        <th>Cost/Unit</th>
                        <th>Total Cost</th>
                        <th>%</th>
                        <th>Discount</th>
                        <th>Extra Costs</th>
                        <th>Method</th>
                        <th>VAT Amount</th>
                        <th>Profit</th>
                        <th>Final Price</th>
                        <th>Notes</th>
                        <th class="action-cell">Actions</th>
                    </tr>
                </thead>
                <tbody id="itemsTableBody">
                    </tbody>
                <tfoot id="table-footer">
                    <tr class="total-row">
                        <td colspan="3"><span id="total-label">Totals</span></td>
                        <td id="totalQty">0</td>
                        <td></td>
                        <td id="totalCost">0</td>
                        <td></td>
                        <td id="totalDiscount">0</td>
                        <td id="totalExtra">0</td>
                        <td></td>
                        <td id="totalVat">0</td>
                        <td id="totalProfit">0</td>
                        <td id="totalPrice">0</td>
                        <td></td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </section>
        
        <section class="controls-container">
            <h2><span id="report-management-title">Report Management</span></h2>
            <div class="button-group">
                <button id="exportExcelBtn" class="action-button"><i class="fas fa-file-excel"></i> <span id="export-excel-btn">Export Excel</span></button>
                <button id="exportPDFBtn" class="action-button"><i class="fas fa-file-pdf"></i> <span id="export-pdf-btn">Export PDF</span></button>
                <button id="printBtn" class="action-button"><i class="fas fa-print"></i> <span id="print-btn">Print Report</span></button>
                <button id="downloadTemplateBtn" class="action-button"><i class="fas fa-download"></i> <span id="download-template-btn">Download Excel Template</span></button>
                <input type="file" id="importExcelInput" accept=".xlsx, .xls" style="display: none;">
                <button id="importExcelBtn" class="action-button"><i class="fas fa-file-import"></i> <span id="import-excel-btn">Import Excel</span></button>
            </div>
        </section>
        
        <section class="charts-container">
            <h2><span id="charts-title">Charts</span></h2>
            <div id="chart-container">
                <div class="chart-box">
                    <canvas id="costProfitBarChart"></canvas>
                </div>
                <div class="chart-box">
                    <canvas id="costProfitPieChart"></canvas>
                </div>
            </div>
        </section>

        <div class="footer">
            <span id="saved-message" class="saved-message"></span>
        </div>
    </div>

    <div id="itemModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeModalBtn">&times;</span>
            <h3 id="modal-title">Add New Item</h3>
            <div class="form-group">
                <label for="itemNameModal" id="item-name-label-modal">Item Name</label>
                <input type="text" id="itemNameModal" required>
                <div class="inline-error" id="nameErrorModal"></div>
            </div>
            <div class="form-group">
                <label for="itemUnitModal" id="unit-label-modal">Unit</label>
                <select id="itemUnitModal"></select>
            </div>
            <div class="form-group">
                <label for="itemQuantityModal" id="qty-label-modal">Quantity</label>
                <input type="text" id="itemQuantityModal" class="numeric-input" inputmode="decimal">
            </div>
            <div class="form-group">
                <label for="itemCostModal" id="cost-label-modal">Cost Per Unit</label>
                <input type="text" id="itemCostModal" class="numeric-input" inputmode="decimal">
            </div>
            <div class="form-group">
                <label for="itemPctModal" id="pct-label-modal">Percentage %</label>
                <input type="text" id="itemPctModal" class="numeric-input" inputmode="decimal">
                <div class="inline-error" id="pctErrorModal"></div>
            </div>
            <div class="form-group">
                <label for="itemDiscountModal" id="discount-label-modal">Discount</label>
                <input type="text" id="itemDiscountModal" class="numeric-input" inputmode="decimal">
                <select id="itemDiscountTypeModal"></select>
            </div>
            <div class="form-group">
                <label for="itemExtraModal" id="extra-label-modal">Extra Costs</label>
                <input type="text" id="itemExtraModal" class="numeric-input" inputmode="decimal">
                <select id="itemExtraTypeModal"></select>
            </div>
            <div class="form-group">
                <label for="itemMethodModal" id="method-label-modal">Method</label>
                <select id="itemMethodModal"></select>
            </div>
            <div class="form-group">
                <input type="checkbox" id="itemVatModal">
                <label for="itemVatModal" id="vat-label-modal">Apply VAT</label>
            </div>
            <div class="form-group">
                <label for="itemNotesModal" id="notes-label-modal">Notes</label>
                <input type="text" id="itemNotesModal">
            </div>
            <button id="saveItemBtn" style="margin-top: 15px;"><span id="save-item-btn-text">Save Item</span></button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable/dist/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
